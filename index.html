<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ø¨Ø·Ø§Ù‚Ø© ØªÙ‡Ù†Ø¦Ø©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body{
      margin:0;
      font-family: Arial, "Segoe UI", system-ui;
      background:#f7f2f3;
    }
    .wrap{max-width:900px;margin:24px auto;padding:12px;}
    .card{
      background:#fff;
      border-radius:16px;
      padding:16px;
      box-shadow:0 8px 24px rgba(0,0,0,.08);
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:end;}
    label{font-weight:700}
    input{
      padding:12px 14px;
      border-radius:10px;
      border:1px solid #ddd;
      min-width:300px;
      font-size:15px;
    }
    button{
      padding:12px 16px;
      border-radius:10px;
      border:0;
      font-weight:700;
      cursor:pointer;
    }
    .primary{background:#6b0f1a;color:#fff;}
    .ghost{background:#eee;color:#6b0f1a}
    canvas{
      width:100%;
      margin-top:14px;
      border-radius:14px;
    }
  </style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="row">
      <div>
        <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label>
        <input id="name" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…" />
      </div>
      <button class="primary" id="gen">Ø¥Ù†Ø´Ø§Ø¡</button>
      <button class="ghost" id="dl" disabled>ØªØ­Ù…ÙŠÙ„</button>
    </div>
    <canvas id="c"></canvas>
  </div>
</div>

<script>
const NAME_COLOR = "#7daab3";
const BASE_FONT_SIZE = 160;
const MIN_FONT_SIZE = 60;
const FONT_FAMILY = 'Arial, "Segoe UI"';

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
const nameInput = document.getElementById("name");
const dlBtn = document.getElementById("dl");

let lastUrl = null;

// ğŸ”¹ Ù‚ÙŠØ§Ø³ Ø§Ù„Ø®Ø· Ø­ØªÙ‰ ÙŠÙ…ØªÙ„Ø¦ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ø®Ø±ÙˆØ¬
function fitFont(text, maxWidth){
  let size = BASE_FONT_SIZE;
  while(size > MIN_FONT_SIZE){
    ctx.font = `800 ${size}px ${FONT_FAMILY}`;
    if(ctx.measureText(text).width <= maxWidth) return size;
    size -= 2;
  }
  return MIN_FONT_SIZE;
}

function generate(){
  const name = nameInput.value.trim();
  if(!name) return alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…");

  const img = new Image();
  img.src = "template.png";

  img.onload = () => {
    // Ù†ÙØ³ Ù…Ù‚Ø§Ø³ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¨Ø§Ù„Ø¶Ø¨Ø·
    canvas.width = img.naturalWidth;
    canvas.height = img.naturalHeight;

    ctx.drawImage(img,0,0);

    // âœ… Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø«Ø§Ø¨ØªØ© (100% ØµØ­)
    const CENTER_X = 540;     // ÙˆØ³Ø· Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„
    const CENTER_Y = 1360;    // Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„
    const MAX_WIDTH = 720;    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„

    const fontSize = fitFont(name, MAX_WIDTH);

    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.direction = "rtl";
    ctx.fillStyle = NAME_COLOR;
    ctx.font = `800 ${fontSize}px ${FONT_FAMILY}`;

    ctx.shadowColor = "rgba(0,0,0,.15)";
    ctx.shadowBlur = 4;
    ctx.shadowOffsetY = 2;

    ctx.fillText(name, CENTER_X, CENTER_Y);

    lastUrl = canvas.toDataURL("image/png");
    dlBtn.disabled = false;
  };
}

function download(){
  const a = document.createElement("a");
  a.href = lastUrl;
  a.download = "Ø¨Ø·Ø§Ù‚Ø©.png";
  a.click();
}

document.getElementById("gen").onclick = generate;
dlBtn.onclick = download;
</script>
</body>
</html>

